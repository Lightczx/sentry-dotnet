@page "/thrower"
@using Sentry.AspNetCore.Blazor

<h1>Throw Exception</h1>

<div>
    <button @onclock=IncrementCount>Click twice to capture error.</button>
    <Sentry.ExampleErrors/>
</div>

@if (SentrySdk.LastEventId != SentryId.Empty)
{
<p>Event Id: @SentrySdk.LastEventId</p>
}

@code {

    // https://learn.microsoft.com/en-us/aspnet/core/blazor/fundamentals/handle-errors?view=aspnetcore-7.0#alternative-global-exception-handling
    [CascadingParameter]
    public SentryBlazor SentryBlazor { get; set; }

    private int _currentCount = 0;

    private void IncrementCount()
    {
        try
        {
            _currentCount++;

            if (_currentCount > 2)
            {
                throw new InvalidOperationException("Current count is over five!");
            }
        }
        catch (Exception ex)
        {
            SentryBlazor?.ProcessError(ex);
        }
    }
}
